<p-dialog 
  [(visible)]="visible" 
  [modal]="true" 
  [style]="{width: '600px'}" 
  [header]="assistant ? 'Edit Assistant' : 'Create Assistant'"
  (onHide)="hideDialog()"
>
  <form [formGroup]="assistantForm" (ngSubmit)="onSubmit()">
    <div class="form-field">
      <label for="name">Name</label>
      <input id="name" type="text" pInputText formControlName="name" />
    </div>

    <div class="form-field">
      <div class="instructions-header">
        <label for="instructions">Instructions</label>
        <p-button 
          icon="pi pi-window-maximize" 
          (onClick)="showInstructionsDialog()"
          [text]="true"
          [rounded]="true"
          styleClass="p-button-sm p-button-secondary"
          pTooltip="Edit in full screen"
        ></p-button>
      </div>
      <textarea
        id="instructions"
        pInputTextarea
        formControlName="instructions"
        [rows]="5"
        [autoResize]="true"
        placeholder="You are a helpful assistant..."
        class="instructions-textarea"
      ></textarea>
    </div>

    <div class="form-field">
      <label for="model">Model</label>
      <p-dropdown
        id="model"
        formControlName="model"
        [options]="availableModels"
        optionLabel="label"
        optionValue="value"
        placeholder="Select a model"
        [style]="{ width: '100%' }"
      ></p-dropdown>
    </div>

    <div class="form-field">
      <label for="temperature">Temperature</label>
      <p-inputNumber
        id="temperature"
        formControlName="temperature"
        [min]="0"
        [max]="2"
        [step]="0.1"
        [showButtons]="true"
        [style]="{ width: '100%' }"
      ></p-inputNumber>
    </div>

    <app-function-list
      [(functions)]="functions"
    ></app-function-list>
  </form>

  <ng-template pTemplate="footer">
    <p-button 
      label="Cancel" 
      icon="pi pi-times" 
      (onClick)="hideDialog()" 
      [outlined]="true"
      [style]="{ marginRight: '.5rem' }"
    ></p-button>
    <p-button 
      label="Save" 
      icon="pi pi-check" 
      (onClick)="onSubmit()"
      [loading]="loading"
    ></p-button>
  </ng-template>
</p-dialog>

<!-- Full screen instructions dialog -->
<p-dialog 
  [(visible)]="showFullScreenInstructions" 
  [modal]="true" 
  [style]="{width: '90vw', height: '90vh'}" 
  header="Edit Instructions"
  [maximizable]="true"
  [closeOnEscape]="true"
  [draggable]="false"
  (onHide)="hideInstructionsDialog()"
>
  <textarea
    pInputTextarea
    [(ngModel)]="fullScreenInstructions"
    [autoResize]="true"
    [style]="{ width: '100%', height: 'calc(100% - 80px)' }"
    class="instructions-textarea"
  ></textarea>

  <ng-template pTemplate="footer">
    <p-button 
      label="Cancel" 
      icon="pi pi-times" 
      (onClick)="hideInstructionsDialog()" 
      [outlined]="true"
      [style]="{ marginRight: '.5rem' }"
    ></p-button>
    <p-button 
      label="Apply" 
      icon="pi pi-check" 
      (onClick)="applyInstructions()"
    ></p-button>
  </ng-template>
</p-dialog>
